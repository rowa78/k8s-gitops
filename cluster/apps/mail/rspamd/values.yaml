replicaCount: 1

image:
  repository: rspamd/rspamd
  pullPolicy: IfNotPresent
  # Overrides the image tag whose default is the chart appVersion.
  tag: ""

imagePullSecrets:
  - name: externalregistry
nameOverride: ""
fullnameOverride: ""

podAnnotations: {}

podSecurityContext: {}

securityContext: {}

service:
  type: ClusterIP
  port: 11334
  controllerPort: 11334
  workerPort: 11332

resources: {}

persistence:
  enabled: true
  storageClass: "openebs-zfs"
  size: 1Gi

# Custom configuration files to be mounted in /custom-config/
config:
  classifier-bayes.conf: |
    servers = "mailserver-redis-headless.mail.svc.cluster.local.";
    backend = "redis";
  redis.conf: |
    read_servers = "mailserver-redis-headless.mail.svc.cluster.local.";
    write_servers = "mailserver-redis-headless.mail.svc.cluster.local.";
  worker-normal.inc: |
    bind_socket = "0.0.0.0:11333";
  worker-proxy.inc: |
    milter = yes; # Enable milter mode
    timeout = 120s; # Needed for Milter usually
    upstream "local" {
      default = yes; # Self-scan upstreams are always default
      self_scan = yes; # Enable self-scan
    }
  options.inc: |
    dns {
      nameserver = ["127.0.0.1:53:10"];
    } 

# Certificates to be mounted in /certs
certificates:
  enabled: false
  secretName: ""

# Additional secrets to be mounted in /custom-config/
secrets: []
  # - name: secret-name
  #   key: secret-key
  #   path: path/in/custom-config

# Additional environment variables
env: []
  # - name: ENV_VAR_NAME
  #   value: "value"

# Unbound configuration
unbound:
  enabled: true
  image:
    repository: registry.rwcloud.org/unbound
    pullPolicy: Always
    tag: "0.1"
  resources: {}
  config:
    unbound.conf: |
      server:
        verbosity: 1
        interface: 0.0.0.0
        port: 53
        do-ip4: true
        do-ip6: true
        do-udp: true
        do-tcp: true
        access-control:
          - 10.0.0.8/24: allow
        hide-identity: true
        hide-version: true
        logfile: "/dev/stdout"
        log-queries: true
        root-hints: "/etc/unbound/root.hints"
        auto-trust-anchor-file: "/var/lib/unbound/root.key"
        aggressive-nsec: false
        log-servfail: true
        harden-glue: true
        harden-dnssec-stripped: true

# Network policy
networkPolicy:
  enabled: false
