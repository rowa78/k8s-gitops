# PKI-Konfiguration
pki "mail" cert "/certs/tls.crt"
pki "mail" key "/certs/tls.key"

# Tabellen für PostgreSQL
table domains file:/secrets/domains
table credentials file:/secrets/passwd
table virtuals file:/secrets/virtuals

# Listener
listen on 0.0.0.0 port 25 tls pki mail hostname terra.rwcloud.org
listen on :: port 25 tls pki mail hostname terra.rwcloud.org
listen on 0.0.0.0 port 587 tls-require pki mail hostname terra.rwcloud.org auth <credentials>
listen on :: port 587 tls-require pki mail hostname terra.rwcloud.org auth <credentials>

# OHNE virtual aliases!
action "domain_mail" lmtp "mailserver-dovecot:24" rcpt-to virtual <virtuals>
action "outbound" relay

# NUR Domain-Check, KEINE Alias-Auflösung
match from any for domain <domains> action "domain_mail"
match from local for any action "outbound"